# Visualization Tools

This directory contains visualization tools and API for the polynomial solver.

## Python API

### solver_viz_api.py

Python API for programmatic visualization of solver geometry dumps.

**Functions:**

- `visualize_solver(dump_file, output_dir, max_steps=None)`: Visualize all or limited iterations
- `get_iteration_count(dump_file)`: Get number of iterations without visualizing
- `visualize_single_iteration(dump_file, iteration_num, output_file)`: Visualize single iteration

**Example usage:**

```python
from tools.solver_viz_api import visualize_solver

# Visualize all iterations
visualize_solver('dumps/example.txt', 'output/')

# Visualize first 20 iterations
visualize_solver('dumps/example.txt', 'output/', max_steps=20)

# Get iteration count
from tools.solver_viz_api import get_iteration_count
count = get_iteration_count('dumps/example.txt')
print(f"Total iterations: {count}")
```

**Command-line usage:**

```bash
python tools/solver_viz_api.py dumps/example.txt --output-dir output/ --max-steps 20
```

## Core Visualization Engine

### visualize_solver.py

Core visualization engine that renders geometry dumps. This is used internally by the API
but can also be used directly from command line.

**Command-line usage:**
```bash
python tools/visualize_solver.py <dump_file> [options]

Options:
  --max-steps N        Maximum number of iterations to visualize (default: all)
  --output-dir DIR     Output directory for PNG files (default: visualization_output)
  -h, --help          Show help message

Examples:
  # Visualize all iterations
  python tools/visualize_solver.py dumps/strategy_ContractFirst_geometry.txt

  # Visualize first 20 iterations
  python tools/visualize_solver.py dumps/strategy_ContractFirst_geometry.txt --max-steps 20

  # Custom output directory
  python tools/visualize_solver.py dumps/example.txt --output-dir my_viz
```

## Dump File Format

The visualization tools read geometry dump files generated by the solver when
`config.dump_geometry = true` is set. The dump file format is:

```
# Polynomial Solver Geometry Dump
# Method: <RootBoundingMethod>
# Dimension: <n>
# Number of equations: <m>

# Iteration <i>, Depth <d>
# Decision: <BOUNDING|SUBDIVISION>
# Global box: [x0_min, x0_max, x1_min, x1_max, ...]

## Direction <j>

### Equation <k>
Projected_Points <count>
<x> <y>
...
ConvexHull <count>
<x> <y>
...
Intersection <count>
<x> <y>
...
```

## Extending Visualization

To add visualization for new features:

1. **For new bounding methods**: The current parser handles ProjectedPolyhedral format.
   Add parsing logic for your method's specific output format.

2. **For 1D problems**: Modify the plotting code to handle 1D visualization
   (line plots instead of 2D scatter plots).

3. **For 3D problems**: Add 3D plotting using matplotlib's mplot3d toolkit.

4. **For new data types**: Extend the parser to handle additional sections
   in the dump file format.

## API Structure

The visualization tool is organized as:

- **Parser**: Reads dump file and extracts iteration data
- **Plotter**: Generates matplotlib figures for each iteration
- **Main**: Orchestrates parsing and plotting

Key functions:
- `parse_dump_file(filename)`: Returns list of iteration data
- `plot_iteration(iteration_data, output_file)`: Generates PNG for one iteration
- `main()`: Command-line interface

## Dependencies

- Python 3.7+
- numpy >= 1.24.0
- matplotlib >= 3.7.0

Install with:
```bash
uv pip install numpy matplotlib
```

## Future Extensions

Planned features:
- Interactive visualization (HTML/JavaScript output)
- Animation generation (GIF/MP4)
- 3D visualization support
- Real-time visualization during solving
- Comparison mode (side-by-side strategy comparison)

